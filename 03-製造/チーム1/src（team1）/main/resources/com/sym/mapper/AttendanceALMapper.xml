<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sym.mapper.AttendanceALMapper">
<select id="attendanceALList" resultType="com.sym.entity.AttendanceAL">
    select * from
        (select t_employees.EMPLOYEES_ID,
                t_attendance_ym.ATTENDANCE_YM,
                t_employees.EMPLOYEES_NAME,
                t_employees.DEPT_ID,
                t_attendance_ym.WORKING_HOURS_MONTH,
                t_attendance_ym.REST_HOURS_MONTH,
                t_attendance_ym.OVERTIME_HOURS_MONTH,
                t_attendance_ym.ABSENCE_HOURS_MONTH,
                t_attendance_ym.APPLY_ID
         from t_attendance_ym
                  left join t_employees on t_employees.EMPLOYEES_ID = t_attendance_ym.EMPLOYEES_ID) as attendanceAL
    <where>
        <if test="employeeId != null and employeeId != ''">
            EMPLOYEES_ID = #{employeeId}
        </if>
        <if test="deptId != null and deptId != ''">
            and DEPT_ID = #{deptId}
        </if>
        <if test="employeeName != null and employeeName != ''">
            and EMPLOYEES_NAME like concat('%', #{employeeId}, '%')
        </if>
        <if test="applyId != null and applyId != ''">
            and APPLY_ID = #{applyId}
        </if>
        <if test="start != null and start != '' and end != null and end != ''">
            and ATTENDANCE_YM between #{start} and #{end}
        </if>
    </where>
</select>
</mapper>